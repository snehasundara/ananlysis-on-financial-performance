!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom"),require("@tableau/widgets"),require("@tableau/dialog-api-contract"),require("@tableau/menu-api-contract"),require("@tableau/preslayer-api-contract")):"function"==typeof define&&define.amd?define(["react","react-dom","@tableau/widgets","@tableau/dialog-api-contract","@tableau/menu-api-contract","@tableau/preslayer-api-contract"],t):"object"==typeof exports?exports.DetailedErrorDialog=t(require("react"),require("react-dom"),require("@tableau/widgets"),require("@tableau/dialog-api-contract"),require("@tableau/menu-api-contract"),require("@tableau/preslayer-api-contract")):e.DetailedErrorDialog=t(e.React,e.ReactDOM,e.SharedWidgets,e.DialogAPIContract,e.MenuAPIContract,e.PresLayerAPIContract)}(self,(function(e,t,r,o,n,i){return function(){"use strict";var a={259:function(e,t,r){function o(){var e,t=e="undefined"!=typeof process&&void 0!==process.release&&"node"===process.release.name?r.g:window;if("string"==typeof CustomLocalizeNamespace&&(t=e[CustomLocalizeNamespace]),void 0===t.Localize)throw Error("The messages.<locale>.js file has not been loaded");return t.Localize}Object.defineProperty(t,"__esModule",{value:!0}),t.Messages=t.CurrentMessageLocale=t.LocaleData=t.getCurrentMessageLocale=t.getLocalizeFormat=void 0,t.getLocalizeFormat=function(){var e=o();if(void 0===e.format)throw Error("The formatters-and-parsers.<locale>.js file has not been loaded");return e.format},t.getCurrentMessageLocale=function(){var e=o();if(void 0===e.message.currentLocale)throw Error("The localize.message.currentLocale has not been set");return e.message.currentLocale},t.LocaleData={get:function(){return(0,t.getLocalizeFormat)().localeData}},t.CurrentMessageLocale={get:function(){return(0,t.getCurrentMessageLocale)()}};var n=function(e,t){return o().msg.formatMessage(e,t)};t.Messages={Copy:function(){return n("@tableau__detailed-error-dialog/Copy")},CopyLinkAddress:function(){return n("@tableau__detailed-error-dialog/CopyLinkAddress")},DismissButtonText:function(){return n("@tableau__detailed-error-dialog/DismissButtonText")},ErrorCodePrefixText:function(){return n("@tableau__detailed-error-dialog/ErrorCodePrefixText")},UnableToCompleteActionText:function(){return n("@tableau__detailed-error-dialog/UnableToCompleteActionText")},CopyErrorMessageLinkText:function(){return n("@tableau__detailed-error-dialog/CopyErrorMessageLinkText")},GoToSupportLinkText:function(){return n("@tableau__detailed-error-dialog/GoToSupportLinkText")},Yes:function(){return n("@tableau__detailed-error-dialog/Yes")},No:function(){return n("@tableau__detailed-error-dialog/No")},ErrorCopiedText:function(){return n("@tableau__detailed-error-dialog/ErrorCopiedText")}}},176:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CopyTextToClipboard=void 0,t.CopyTextToClipboard=function(e,t){return t.invokeCommand("tabui","copy-text-to-clipboard",e)}},160:function(e,t,r){var o,n=this&&this.__extends||(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.DetailedErrorComponent=t.ErrorDetailsContainerTestId=t.ErrorShortMessageTestId=t.DialogTestId=void 0;var a=r(98),s=r(262),l=r(272),p=r(599),u=r(79),c=r(259),d=r(250),y=r(272),f="copy",g="copylink";t.DialogTestId="detailedErrorDialog",t.ErrorShortMessageTestId="error-short-message",t.ErrorDetailsContainerTestId="error-details-container";var h=function(e){function r(t){var r=e.call(this,t)||this;return r.autoResetBtnRef=a.createRef(),r.onContextMenu=r.onContextMenu.bind(r),r.onMouseDown=r.onMouseDown.bind(r),r}return n(r,e),r.prototype.onMouseDown=function(e){2===e.button&&e.preventDefault()},r.prototype.onContextMenu=function(e){var t=this,r=e.target,o=r.getBoundingClientRect(),n={position:{anchorElement:r,anchorOffset:{x:e.clientX-o.left,y:e.clientY-o.top}}},i=[];null!==document.getSelection()&&i.push({disabled:!1,displayValue:c.Messages.Copy(),key:f,type:"entry"}),r instanceof HTMLAnchorElement&&i.push({disabled:!1,displayValue:c.Messages.CopyLinkAddress(),key:g,type:"entry"}),i.length>0&&d.Instance.Show(n,i).then((function(e){var o=window.getSelection();e.key===f&&o?t.props.copyText(o.toString()):e.key===g&&t.props.copyText(r.href.toString())})).catch((function(){}))},r.prototype.componentDidMount=function(){null!==document.activeElement&&document.activeElement.blur();var e=s.findDOMNode(this.autoResetBtnRef.current);e&&e.focus()},r.prototype.shouldRenderErrorDetailsContainer=function(){return!!(this.props.errorDetails.length>0||this.props.queryDetails)},r.prototype.renderErrorCode=function(){return this.props.errorCode?a.createElement("div",{key:"error-code",className:"error-code",style:p.errorShortMessageStyle},this.props.errorCode):null},r.prototype.render=function(){var e=this,r=(t.DialogTestId,{testId:t.DialogTestId,isModal:!0,showCloseButton:!0,showTitleBar:!0,title:this.props.errorDialogTitle,dialogWidth:500,onCloseRequest:this.props.onClose}),o=void 0;if(this.shouldRenderErrorDetailsContainer()){var n=this.props.errorDetails.map((function(e,t){return a.createElement("div",{key:"errorDetail-"+t,style:p.errorDetailsStyle},e)})),s=Object.keys(this.props.issueHelperLinks).map((function(t,r){return a.createElement("div",{key:"issueHelperLinks-"+r,style:p.defectInvestigationLink},a.createElement(y.Tooltip,{followCursor:!1,getContent:function(){return a.createElement("span",null,e.props.issueHelperLinks[t])},position:y.TooltipPosition.Top,testId:"issue-helper-link-tooltip"+r},a.createElement(y.TextLinkWidget,{href:e.props.issueHelperLinks[t],kind:y.TextLinkKind.Standard,testId:"issue-helper-link"+r,target:"_blank"},t)))}));o=a.createElement("div",{"data-tb-test-id":t.ErrorDetailsContainerTestId,className:"error-details",style:p.errorDetailsContainer},n,s,a.createElement("div",{style:p.queryDetailsContainer},this.props.queryDetails))}return a.createElement(u.DialogWidget,i({},r),a.createElement("div",{className:r.testId,onContextMenu:this.onContextMenu,onMouseDown:this.onMouseDown},a.createElement("div",{"data-tb-test-id":t.ErrorShortMessageTestId,className:"error-short-message",role:"alert",style:p.errorShortMessageStyle},this.props.errorShortMessage),this.renderErrorCode(),o,a.createElement("textarea",{readOnly:!0,tabIndex:-1,"aria-hidden":"true",id:"copy_text_area",style:p.copyTextareaStyle,defaultValue:this.props.copyTextValue}),a.createElement("div",{style:p.actionAreaStyle},a.createElement("div",null,a.createElement(y.TextLinkWidget,{href:this.props.errorHelpLink,kind:y.TextLinkKind.Standard,testId:"error-support-link",target:"_blank"},c.Messages.GoToSupportLinkText())),a.createElement("div",{style:p.btnGroupStyle},a.createElement(l.AutoResetButton,{testId:"copy",label:c.Messages.CopyErrorMessageLinkText(),buttonType:l.ButtonType.Outline,style:p.copyTextBtnStyle,handleClick:function(){return e.props.copyText(e.props.copyTextValue)},delayLabel:c.Messages.ErrorCopiedText(),ref:this.autoResetBtnRef,handleReset:function(){}}),void 0,void 0))))},r}(a.Component);t.DetailedErrorComponent=h},866:function(e,t,r){var o=r(418);e.exports=o.DialogPlugin},181:function(e,t,r){var o,n=this&&this.__extends||(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.DetailedErrorViewModel=void 0;var a=r(98),s=r(160),l=r(259),p=r(176),u=function(e){function t(t){var r=e.call(this,t)||this;return r.copyText=function(e){r.props.pm.useCopyCommand?p.CopyTextToClipboard({valueString:e},r.props.presLayer):r.copyTextToClipboard(e)},r}return n(t,e),t.prototype.errorDialogTitle=function(){return this.props.pm.errorDialogTitle||l.Messages.UnableToCompleteActionText()},t.prototype.errorShortMessage=function(){return this.props.pm.errorShortMessage||""},t.prototype.errorDetails=function(){return this.props.pm.errorDetails||[""]},t.prototype.hasErrorCode=function(){return 0!==this.props.pm.errorCodeId},t.prototype.getErrorCodeText=function(){return l.Messages.ErrorCodePrefixText()+this.getErrorCode()+"\n"},t.prototype.getErrorCode=function(){return this.formatErrorCodePart(this.props.pm.errorCodeId)},t.prototype.appendErrorCodeToUrl=function(e){if(this.hasErrorCode()){var t=e.indexOf("?")+1,r=e.indexOf("#")+1,o=(t?"&":"?")+"errorcode="+this.getErrorCode();e=r?e.replace("#",o+"#"):e+o}return e},t.prototype.appendErrorCodeToCopyTextArea=function(){return this.hasErrorCode()?this.getErrorCodeText():""},t.prototype.formatErrorCodePart=function(e){return 0===e?"0":("00000000"+e.toString(16)).substr(-8).toUpperCase()},t.prototype.errorHelpLink=function(){var e=this.props.pm.errorHelpLink||"https://www.tableau.com/support";return this.appendErrorCodeToUrl(e)},t.prototype.getQueryDetails=function(){return this.props.pm.queryDetails||""},t.prototype.issueHelperLinks=function(){return this.props.pm.issueHelperLinks?JSON.parse(this.props.pm.issueHelperLinks):{}},t.prototype.getErrorTextToCopy=function(){var e=""===this.getQueryDetails()?"":"\n"+this.getQueryDetails();return this.errorDialogTitle()+"\n"+this.errorShortMessage()+"\n"+this.appendErrorCodeToCopyTextArea()+this.errorDetails().join("\n")+e},t.prototype.callCommand=function(e){if(null!==e){var t=e.commandParams?e.commandParams:{};return this.props.presLayer.invokeCommand(e.commandNamespace,e.commandName,t)}return Promise.reject("command was null")},t.prototype.copyTextToClipboard=function(e){var t=document.getElementById("copy_text_area");t.value=e;var r=null,o=document.getSelection();o&&(o.rangeCount>0&&(r=o.getRangeAt(0)),navigator.userAgent.match(/ipad|ipod|iphone/i)?this.iosSelectTextArea(t):t.select(),document.execCommand("copy"),o.removeAllRanges(),null!==r&&o.addRange(r))},t.prototype.iosSelectTextArea=function(e){var t=e.contentEditable;e.contentEditable="true";var r=document.createRange();r.selectNodeContents(e);var o=window.getSelection();o&&(o.removeAllRanges(),o.addRange(r));var n=e.value.length;e.setSelectionRange(0,n),e.contentEditable=t},t.prototype.render=function(){var e={errorDialogTitle:this.errorDialogTitle(),errorShortMessage:this.errorShortMessage(),errorDetails:this.errorDetails(),errorCode:this.hasErrorCode()?this.getErrorCodeText():"",errorHelpLink:this.errorHelpLink(),queryDetails:this.getQueryDetails(),issueHelperLinks:this.issueHelperLinks(),copyTextValue:this.getErrorTextToCopy(),onClose:this.props.onClose,copyText:this.copyText};return a.createElement(s.DetailedErrorComponent,i({},e))},t}(a.Component);t.DetailedErrorViewModel=u},418:function(e,t,r){var o,n=this&&this.__extends||(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.DialogPlugin=void 0;var i=r(98),a=r(262),s=r(181),l=r(827),p=function(){function e(){this.closeDialog=function(){}}return e.prototype.showDialog=function(e,t,r){var o=this;this.closeDialog=function(){a.unmountComponentAtNode(t),r(),o.closeDialog=function(){}},a.render(i.createElement(u,{presLayer:l.Instance,onClose:function(){setTimeout((function(){o.closeDialog()}),0)},initialState:e}),t)},e.prototype.forceCloseDialog=function(){this.closeDialog()},e}();t.DialogPlugin=p;var u=function(e){function t(t){var r=e.call(this,t)||this;return r.unregisterNotificationHandler=t.presLayer.registerNotificationHandler("doc:update-detailed-error-dialog-event",(function(e){r.setState(e)})),r.applyLocalChanges=r.applyLocalChanges.bind(r),r}return n(t,e),t.prototype.getPresModel=function(){return this.state||this.props.initialState},t.cloneObject=function(e){return JSON.parse(JSON.stringify(e))},t.prototype.applyLocalChanges=function(e){var r=t.cloneObject(this.getPresModel());e(r),this.setState(r)},t.prototype.render=function(){return i.createElement(s.DetailedErrorViewModel,{presLayer:this.props.presLayer,onClose:this.props.onClose,pm:this.getPresModel(),updatePresModel:this.applyLocalChanges})},t.prototype.componentWillUnmount=function(){var e;null===(e=this.unregisterNotificationHandler)||void 0===e||e.call(this)},t}(i.Component)},599:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.btnGroupStyle=t.actionAreaStyle=t.copyTextBtnStyle=t.goToSupportStyle=t.copyTextareaStyle=t.errorDetailsStyle=t.queryDetailsContainer=t.defectInvestigationLink=t.errorDetailsContainer=t.errorShortMessageStyle=void 0;var o=r(272),n=o.TabStyles.Spacing,i=o.TabStyles.Typography.Color;t.errorShortMessageStyle={color:i.Primary,paddingBottom:n.LargeSpace,maxHeight:"400px",overflowY:"auto",WebkitUserSelect:"text",whiteSpace:"pre-wrap",wordWrap:"break-word"},t.errorDetailsContainer={border:"solid",borderWidth:"1px",borderColor:o.TabStyles.Colors.F6,padding:n.DefaultSpace,maxHeight:"500px",overflowY:"auto",wordWrap:"break-word"},t.defectInvestigationLink={paddingBottom:n.DefaultSpace},t.queryDetailsContainer={whiteSpace:"pre-wrap",WebkitUserSelect:"text"},t.errorDetailsStyle={paddingBottom:n.DefaultSpace,WebkitUserSelect:"text"},t.copyTextareaStyle={opacity:0,height:"0px"},t.goToSupportStyle={textDecoration:"none"},t.copyTextBtnStyle={color:i.Primary},t.actionAreaStyle={display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},t.btnGroupStyle={display:"flex"}},79:function(e){e.exports=o},250:function(e){e.exports=n},827:function(e){e.exports=i},98:function(t){t.exports=e},262:function(e){e.exports=t},272:function(e){e.exports=r}},s={};function l(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={exports:{}};return a[e].call(r.exports,r,r.exports,l),r.exports}return l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l(866)}()}));
//# sourceMappingURL=detailed-error-dialog.min.js.map